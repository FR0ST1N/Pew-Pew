<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>enemy/level.js - Pew Pew - Docs</title>
    
    <meta name="description" content="Docementation for Pew Pew (JavaScript Game)" />
    
        <meta name="keywords" content="javascript game, pew pew, game, html5" />
        <meta name="keyword" content="javascript game, pew pew, game, html5" />
    
    
    
    <meta property="og:title" content="Pew Pew - Docs"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    <meta property="og:site_name" content="Pew Pew - Docs"/>
    <meta property="og:url" content="https://fr0st1n.github.io/Pew-Pew/docs/"/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/FR0ST1N/Pew-Pew" target="_blank" class="menu-item" id="website_link" >GitHub Repository</a></h2><h2><a href="https://fr0st1n.github.io/Pew-Pew/" target="_blank" class="menu-item" id="game_link" >Play Game</a></h2><h3>Classes</h3><ul><li><a href="animationHelper.html">animationHelper</a><ul class='methods'><li data-type='method'><a href="animationHelper.html#objectAnimation">objectAnimation</a></li><li data-type='method'><a href="animationHelper.html#objectUpdate">objectUpdate</a></li><li data-type='method'><a href="animationHelper.html#postObjectUpdate">postObjectUpdate</a></li><li data-type='method'><a href="animationHelper.html#setContext">setContext</a></li><li data-type='method'><a href="animationHelper.html#wDraw">wDraw</a></li></ul></li><li><a href="AudioEffects.html">AudioEffects</a><ul class='methods'><li data-type='method'><a href="AudioEffects.html#._playSound">_playSound</a></li><li data-type='method'><a href="AudioEffects.html#.playBarrierSound">playBarrierSound</a></li><li data-type='method'><a href="AudioEffects.html#.playEnemyDamageSound">playEnemyDamageSound</a></li><li data-type='method'><a href="AudioEffects.html#.playEnemyPewSound">playEnemyPewSound</a></li><li data-type='method'><a href="AudioEffects.html#.playPlayerDamageSound">playPlayerDamageSound</a></li><li data-type='method'><a href="AudioEffects.html#.playPlayerPewSound">playPlayerPewSound</a></li><li data-type='method'><a href="AudioEffects.html#.playUiSound">playUiSound</a></li></ul></li><li><a href="Bullet.html">Bullet</a><ul class='methods'><li data-type='method'><a href="Bullet.html#collideDetect">collideDetect</a></li><li data-type='method'><a href="Bullet.html#despawn">despawn</a></li><li data-type='method'><a href="Bullet.html#fire">fire</a></li><li data-type='method'><a href="Bullet.html#getBulletPosition">getBulletPosition</a></li><li data-type='method'><a href="Bullet.html#setBulletPostition">setBulletPostition</a></li><li data-type='method'><a href="Bullet.html#setBulletTarget">setBulletTarget</a></li><li data-type='method'><a href="Bullet.html#setPlayerPositionSnap">setPlayerPositionSnap</a></li></ul></li><li><a href="BulletAnimationHelper.html">BulletAnimationHelper</a><ul class='methods'><li data-type='method'><a href="BulletAnimationHelper.html#objectUpdate">objectUpdate</a></li></ul></li><li><a href="BulletMovement.html">BulletMovement</a><ul class='methods'><li data-type='method'><a href="BulletMovement.html#_Movement">_Movement</a></li><li data-type='method'><a href="BulletMovement.html#_playerBulletMotion">_playerBulletMotion</a></li><li data-type='method'><a href="BulletMovement.html#fire">fire</a></li><li data-type='method'><a href="BulletMovement.html#follow">follow</a></li><li data-type='method'><a href="BulletMovement.html#isPlayerMode">isPlayerMode</a></li><li data-type='method'><a href="BulletMovement.html#setPlayerMode">setPlayerMode</a></li><li data-type='method'><a href="BulletMovement.html#straight">straight</a></li></ul></li><li><a href="CollisionDetection.html">CollisionDetection</a><ul class='methods'><li data-type='method'><a href="CollisionDetection.html#.detect">detect</a></li></ul></li><li><a href="Enemy.html">Enemy</a><ul class='methods'><li data-type='method'><a href="Enemy.html#_autoshoot">_autoshoot</a></li><li data-type='method'><a href="Enemy.html#checkHealthAndDespawn">checkHealthAndDespawn</a></li><li data-type='method'><a href="Enemy.html#collideDetect">collideDetect</a></li><li data-type='method'><a href="Enemy.html#setBulletPattern">setBulletPattern</a></li><li data-type='method'><a href="Enemy.html#setPlayerPosition">setPlayerPosition</a></li><li data-type='method'><a href="Enemy.html#shoot">shoot</a></li><li data-type='method'><a href="Enemy.html#takeDamage">takeDamage</a></li></ul></li><li><a href="EnemyAnimationHelper.html">EnemyAnimationHelper</a><ul class='methods'><li data-type='method'><a href="EnemyAnimationHelper.html#_fireAnimation">_fireAnimation</a></li><li data-type='method'><a href="EnemyAnimationHelper.html#_idleAnimation">_idleAnimation</a></li><li data-type='method'><a href="EnemyAnimationHelper.html#getFireState">getFireState</a></li><li data-type='method'><a href="EnemyAnimationHelper.html#objectUpdate">objectUpdate</a></li><li data-type='method'><a href="EnemyAnimationHelper.html#triggerFireState">triggerFireState</a></li></ul></li><li><a href="EnemyMovement.html">EnemyMovement</a><ul class='methods'><li data-type='method'><a href="EnemyMovement.html#_directionDecision">_directionDecision</a></li><li data-type='method'><a href="EnemyMovement.html#_enemyPositionUpdate">_enemyPositionUpdate</a></li><li data-type='method'><a href="EnemyMovement.html#_Movement">_Movement</a></li><li data-type='method'><a href="EnemyMovement.html#startAnimation">startAnimation</a></li></ul></li><li><a href="EnemySpawner.html">EnemySpawner</a><ul class='methods'><li data-type='method'><a href="EnemySpawner.html#_bulletsDraw">_bulletsDraw</a></li><li data-type='method'><a href="EnemySpawner.html#_checkCollisionWithPlayer">_checkCollisionWithPlayer</a></li><li data-type='method'><a href="EnemySpawner.html#_enemiesDraw">_enemiesDraw</a></li><li data-type='method'><a href="EnemySpawner.html#draw">draw</a></li><li data-type='method'><a href="EnemySpawner.html#isBulletInsideCanvas">isBulletInsideCanvas</a></li></ul></li><li><a href="Font.html">Font</a><ul class='methods'><li data-type='method'><a href="Font.html#._getChars">_getChars</a></li><li data-type='method'><a href="Font.html#.draw">draw</a></li></ul></li><li><a href="Game.html">Game</a><ul class='methods'><li data-type='method'><a href="Game.html#_createPlayer">_createPlayer</a></li><li data-type='method'><a href="Game.html#_drawGame">_drawGame</a></li><li data-type='method'><a href="Game.html#_render">_render</a></li><li data-type='method'><a href="Game.html#_resetGame">_resetGame</a></li><li data-type='method'><a href="Game.html#init">init</a></li></ul></li><li><a href="Level.html">Level</a><ul class='methods'><li data-type='method'><a href="Level.html#_setNewPlayer">_setNewPlayer</a></li><li data-type='method'><a href="Level.html#enenmyOneFactory">enenmyOneFactory</a></li><li data-type='method'><a href="Level.html#levelTrigger">levelTrigger</a></li><li data-type='method'><a href="Level.html#reset">reset</a></li><li data-type='method'><a href="Level.html#triggerNextLevel">triggerNextLevel</a></li></ul></li><li><a href="Player.html">Player</a><ul class='methods'><li data-type='method'><a href="Player.html#_absorbAnimation">_absorbAnimation</a></li><li data-type='method'><a href="Player.html#_absorbKeyDown">_absorbKeyDown</a></li><li data-type='method'><a href="Player.html#_absorbKeyUp">_absorbKeyUp</a></li><li data-type='method'><a href="Player.html#_bulletDraw">_bulletDraw</a></li><li data-type='method'><a href="Player.html#_bulletsDraw">_bulletsDraw</a></li><li data-type='method'><a href="Player.html#_checkCollisionWithEnemy">_checkCollisionWithEnemy</a></li><li data-type='method'><a href="Player.html#_drawFrame">_drawFrame</a></li><li data-type='method'><a href="Player.html#_fireAnimation">_fireAnimation</a></li><li data-type='method'><a href="Player.html#_fireBullet">_fireBullet</a></li><li data-type='method'><a href="Player.html#_fireKeyDown">_fireKeyDown</a></li><li data-type='method'><a href="Player.html#_idleAnimation">_idleAnimation</a></li><li data-type='method'><a href="Player.html#_moveKeyDown">_moveKeyDown</a></li><li data-type='method'><a href="Player.html#_moveKeyUp">_moveKeyUp</a></li><li data-type='method'><a href="Player.html#_playerBulletCollisionWithEnemy">_playerBulletCollisionWithEnemy</a></li><li data-type='method'><a href="Player.html#_returnToIdle">_returnToIdle</a></li><li data-type='method'><a href="Player.html#_startInputListeners">_startInputListeners</a></li><li data-type='method'><a href="Player.html#_stopInputListeners">_stopInputListeners</a></li><li data-type='method'><a href="Player.html#decrementBulletCount">decrementBulletCount</a></li><li data-type='method'><a href="Player.html#decrementLife">decrementLife</a></li><li data-type='method'><a href="Player.html#destroy">destroy</a></li><li data-type='method'><a href="Player.html#incrementBulletCount">incrementBulletCount</a></li><li data-type='method'><a href="Player.html#init">init</a></li><li data-type='method'><a href="Player.html#isBulletInsideCanvas">isBulletInsideCanvas</a></li><li data-type='method'><a href="Player.html#playerMovement">playerMovement</a></li><li data-type='method'><a href="Player.html#setLevel">setLevel</a></li></ul></li><li><a href="PlayerUtil.html">PlayerUtil</a><ul class='methods'><li data-type='method'><a href="PlayerUtil.html#.bound">bound</a></li><li data-type='method'><a href="PlayerUtil.html#.getBarrierPosition">getBarrierPosition</a></li><li data-type='method'><a href="PlayerUtil.html#.imgDrawCall">imgDrawCall</a></li><li data-type='method'><a href="PlayerUtil.html#.isIdleAnim">isIdleAnim</a></li></ul></li><li><a href="Position.html">Position</a></li><li><a href="Score.html">Score</a><ul class='methods'><li data-type='method'><a href="Score.html#getScore">getScore</a></li><li data-type='method'><a href="Score.html#resetScore">resetScore</a></li><li data-type='method'><a href="Score.html#setScore">setScore</a></li></ul></li><li><a href="Sprite.html">Sprite</a></li><li><a href="SpriteConfig.html">SpriteConfig</a><ul class='methods'><li data-type='method'><a href="SpriteConfig.html#_extractSprites">_extractSprites</a></li></ul></li><li><a href="SpriteSheet.html">SpriteSheet</a><ul class='methods'><li data-type='method'><a href="SpriteSheet.html#addSprite">addSprite</a></li><li data-type='method'><a href="SpriteSheet.html#addSpriteBulk">addSpriteBulk</a></li><li data-type='method'><a href="SpriteSheet.html#getSprite">getSprite</a></li><li data-type='method'><a href="SpriteSheet.html#getSpritePosition">getSpritePosition</a></li></ul></li><li><a href="Timer.html">Timer</a><ul class='methods'><li data-type='method'><a href="Timer.html#_resetAnimationTimer">_resetAnimationTimer</a></li><li data-type='method'><a href="Timer.html#_resetMotionTimer">_resetMotionTimer</a></li><li data-type='method'><a href="Timer.html#isTimeToAnimate">isTimeToAnimate</a></li><li data-type='method'><a href="Timer.html#isTimeToMove">isTimeToMove</a></li><li data-type='method'><a href="Timer.html#stepTimer">stepTimer</a></li></ul></li><li><a href="UserInterface.html">UserInterface</a><ul class='methods'><li data-type='method'><a href="UserInterface.html#_drawBulletCount">_drawBulletCount</a></li><li data-type='method'><a href="UserInterface.html#_drawControls">_drawControls</a></li><li data-type='method'><a href="UserInterface.html#_drawHealth">_drawHealth</a></li><li data-type='method'><a href="UserInterface.html#_drawLogo">_drawLogo</a></li><li data-type='method'><a href="UserInterface.html#_drawScore">_drawScore</a></li><li data-type='method'><a href="UserInterface.html#_uiInput">_uiInput</a></li><li data-type='method'><a href="UserInterface.html#_uiInputListener">_uiInputListener</a></li><li data-type='method'><a href="UserInterface.html#draw">draw</a></li><li data-type='method'><a href="UserInterface.html#init">init</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#main">main</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">enemy/level.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file handles level creation and enemy spawner.
 * @author bluepie &lt;gopinath2nr@gmail.com>
 */
class EnemySpawner {
  /**
     * @param {Object} object
     */
  constructor(object) {
    const obj = object;
    this.context = obj.ctx;
    this.player = obj.globalObject.player;
    this.drawableObjects = [];
    this.UI = obj.globalObject.ui;
  }

  /** responsible for drawing
    * enemies and bullets inside canvas from requestAnimationFrame.
    * eHolder = if the current level monsters are defeated, trigger next level
    */
  draw() {
    let eHolder = []; /* check current level monsters to trigger next level */
    this.drawableObjects.forEach((enemy) => {
      if (this._enemiesDraw(enemy)) {/* omites enemies having health &lt; 1 */
        eHolder.push(enemy);
      } /* filter omits bullet if bullet is outside canvas */
      enemy.bullet = enemy.bullet.filter(this._bulletsDraw.bind(this));
    }); /* trigger next level */
    eHolder = (eHolder.length == 0) ? this.gameEnd = false : [];
  }


  /**
   * only draw enemies if they have health
   * @param {Enemy} enemy
   * @return {boolean} - enemy is drawable and has health
   */
  _enemiesDraw(enemy) {
    if (enemy.health &lt; 1 || enemy.health == null) {
      enemy.checkHealthAndDespawn();
      return false;
    } enemy.wDraw();
    enemy.setPlayerPosition(this.player.position.x, this.player.position.y);
    return true;
  }

  /**
     * filters only the bullets which are inside..
     * @param {Bullet} Enemybullet
     * @return {boolean}
     */
  _bulletsDraw(Enemybullet) {
    if (Enemybullet != null || Enemybullet != undefined) {
      if (!this.isBulletInsideCanvas(Enemybullet)) {
        Enemybullet.despawn();
        return false;
      } /* collision detection with player before draw */
      this._checkCollisionWithPlayer(Enemybullet);
      return true;
    }
  }

  /**
     * check bullets postion in-relattion to canvas.
     * @param {Bullet} bullet
     * @return {boolean}
     */
  isBulletInsideCanvas(bullet) {
    if (bullet.position == null) {
      return false;
    }
    if (bullet.getBulletPosition().x > 0 &amp;&amp; /* check only left side*/
       bullet.getBulletPosition().y > 0) {
      return true;
    } return false;
  }

  /**
   * @param {Bullet} bullet
   */
  _checkCollisionWithPlayer(bullet) {
    const collideWithPlayerStatus = bullet
        .collideDetect(new Position(this.player.position.x,
            this.player.position.y));
    if (!collideWithPlayerStatus) {/* if collides with player, dont draw */
      bullet.wDraw();
    } else {
      bullet.despawn();
      if (this.player.pressed.absorb) {
        this.player.incrementBulletCount();
        return;
      }
      this.player.decrementLife();
    }
  }
}


// examples:
//  /* enemy sprite, look into sprite.js for more info */
// const spriteEnemy1 = new Sprite('enemy1.png', 2, 2, 128, 32,
//     new Position(0, 0), 3, 3);
//   /* enemy sprite config, based on rows and columns */
// const spriteConfigEnemy1 = new SpriteConfig(['idle1', 'idle2'],
//     ['fire1', 'fire2'], spriteEnemy1);
//   /* start spawn position of enemy */
// const positionEnemy1 = new Position(500, 500);

// /* enemy creation */
// const enemy1 = new Enemy(spriteEnemy1, spriteConfigEnemy1,
//     positionEnemy1, 3);

// /* start enemy process, all bullet related is handled inside. */
// enemy1.startAnimation(this.context);

// /* enabling autofire for the enemy */
// enemy1.autoshoot = true;

// /* overriding default bullet Pattern */
// enemy1.setBulletPattern(BulletPattern.FOLLOW);

// /* shoot must be called only after setting the context  */
// enemy1.shoot();

// /**
//    * push enemy into drawableObjects, used in EnemySpawner::draw,
//    * newly created enemies must be pushed into drawableObjects.
//    */
// this.drawableObjects.push(enemy1);
/**
 * level design
 * available configurations:
 * enemies: enemy1, enemy2
 *  enemy-property-variations: health, rateOfFire, autofire
 *                             bullet
 *    bullet configuraions:currently only one sprite
 *      bullet-properties: speed, pattern(bulletPattern), damage,
 *                         bulletPattern -> straight (or) follow
 *
 */
class Level extends EnemySpawner {
  /**
   * constructor
   * @param {Object} object
   */
  constructor(object) {
    super(object);
    this.levelEndStatus = false;
    this.level = 0; /* number */
    this.currentLevelEnemies = []; /* array */
    this.gameEnd = false;
    this.score = object.globalObject.score;
  }

  /**
   * triggers next level
   */
  triggerNextLevel() {
    this.currentLevelEnemies = []; /* reset current level enemies */
    this.drawableObjects = [];
    this.level += 1;
    this.levelTrigger();
  }

  /**
   * resets the level
   * @param {Player} player
   */
  reset(player) {
    this.level = 0;
    this._setNewPlayer(player);
  }

  /**
   * Sets the instance of the new player (used on level reset)
   * @param {Player} player A player instance.
   */
  _setNewPlayer(player) {
    this.player = player;
  }

  /**
   * design
   * level one:
   *  one enemy, straight bullet, health = 1, rateOfFire = (1000-100/level=1)
   * level two:
   *  two enemy:
   *    1st enemy: straight bullet, health = 2, rateOfFire = (1000-100/level=2)
   *    last enemy: follow bullet, health,rateOfFire=same as 1st enemy
   * ... progressive, all the last enemy has the follow bullet
   */
  levelTrigger() {
    for (let enemyCounter = 1; enemyCounter &lt;= this.level;
      enemyCounter++ ) {
      const enemy = this.enenmyOneFactory(
          new Position(800, enemyCounter * 50 + 100),
          this.level,
          (1000 - 100) / this.level);
      enemy.startAnimation(this.context);
      enemy.autoshoot = true;
      if (this.level != 1 &amp;&amp; enemyCounter == this.level) {
        enemy.setBulletPattern(BulletPattern.FOLLOW);
      }
      enemy.shoot();
      this.currentLevelEnemies.push(enemy);
      this.drawableObjects.push(enemy);
    }
  }

  /**
   * creates enemy bashed on sprite 'enemy1.png'
   * @param {Position} position
   * @param {number} health
   * @param {number} rateOfFire
   * @return {Enemy} enemyObject
   */
  enenmyOneFactory(position, health, rateOfFire) {
    const spriteEnemyOne = new Sprite('enemy1.png', 2, 2, 128, 32,
        new Position(0, 0), 2, 2);
    const spriteConfigEnemyOne = new SpriteConfig(['idle1', 'idle2'],
        ['fire1', 'fire2'], spriteEnemyOne);
    const enemyPosition = position;
    const enemy = new Enemy(this.UI, this.score, spriteEnemyOne,
        spriteConfigEnemyOne, enemyPosition, health, rateOfFire);
    return enemy;
  }
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
