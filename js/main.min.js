class Util{static getBarrierPosition(t,e,i){return i*(e-t)/2}static isIdleAnim(t){return 0===t||1===t}static exitFire(t,e){return!(!t||!this.isIdleAnim(e))}static imgDrawCall(t,e,i,s,h,r,l){const a=e.getSprite(i);null!=a&&t.drawImage(e.image,a.x,a.y,s,s,h,r,s*l,s*l)}}class Animator{constructor(){this.frameCounter=0,this.animState=0}idleAnimation(){this.frameCounter<=15?this.animState=0:this.frameCounter>=16&&this.frameCounter<=30&&(this.animState=1),30===this.frameCounter&&(this.frameCounter=0)}fireAnimation(){this.frameCounter<=7?0===this.animState?this.animState=2:1===this.animState&&(this.animState=3):this.frameCounter>7&&this.returnToIdle(2,3)}returnToIdle(t,e){this.animState===t?(this.animState=1,this.frameCounter=15):this.animState===e&&(this.animState=0,this.frameCounter=0)}resetFrameCounter(){this.frameCounter=0}get state(){return this.animState}set incrementFrame(t){this.frameCounter=this.frameCounter+t}}class AudioEffects{static playPlayerPewSound(){this._playSound([1,,.2795,,.1338,.6607,.294,-.2058,,,,,,.5423,-.5507,,,,1,,,,,.5])}static playEnemyPewSound(){this._playSound([2,,.2,,.1753,.64,,-.5261,,,,,,.5522,-.564,,,,1,,,,,.5])}static playBarrierSound(){this._playSound([0,,.086,,.2876,.2768,,.4249,,,,,,.0168,,.5209,,,1,,,,,.5])}static playPlayerDamageSound(){this._playSound([3,,.1606,.5988,.2957,.1157,,-.3921,,,,,,,,,.3225,-.2522,1,,,,,.5])}static playEnemyDamageSound(){this._playSound([0,,.0639,,.2425,.7582,,-.6217,,,,,,.4039,,,,,1,,,,,.5])}static playUiSound(){this._playSound([1,,.1401,,.1884,.5359,,,,,,,,,,,,,1,,,.1,,.5])}static _playSound(t){const e=jsfxr(t),i=new Audio;i.src=e,i.play()}}class Score{constructor(){this._score=0}getScore(){return this._score}setScore(t){this._score+=t}resetScore(){this._score=0}}class SpriteSheet{constructor(t,e){this.image=t,this.spriteSize=e,this.sprites=[]}addSprite(t){this.sprites.push({name:t.name,x:t.x,y:t.y})}addSpriteBulk(t,e,i){if(e*i===t.length){let s=0;for(let h=0;h<e;h++)for(let e=0;e<i;e++)this.addSprite({name:t[s++],x:e*this.spriteSize,y:h*this.spriteSize})}}getSprite(t){for(const e of this.sprites)if(e.name===t)return e}getSpritePosition(t){for(const e of this.sprites)if(e.name===t)return new Position(e.x,e.y)}}class PlayerAnimator extends Animator{constructor(){super()}absorbAnimation(){0===this.animState?(this.animState=4,this._resetAndIncrement()):1===this.animState?(this.animState=5,this._resetAndIncrement()):this.frameCounter<=15?this.animState=4:this.frameCounter>=16&&this.frameCounter<=30&&(this.animState=5),30===this.frameCounter&&this.resetFrameCounter()}_resetAndIncrement(){this.resetFrameCounter(),this.incrementFrame=1}}class Player{constructor(t,e,i,s,h,r,l=3,a=5){t.image=r[0],this.spriteSheet=t,this.spriteNames=e,this.ctx=i,this.canvasSize=s,this.keys=h,this.images=r,this.lives=l,this.maxBulletSize=a,this.bulletCount=0,this.absorbState=!1,this.pressed={left:!1,up:!1,right:!1,down:!1,pew:!1,absorb:!1},this.scale={player:2,barrier:3},this.position={x:15,y:s.height/2-t.spriteSize*this.scale.player/2},this.playerSpriteSheet=new SpriteSheet(t.image,t.spriteSize),this.playerAnimator=new PlayerAnimator,this.bulletManager=new BulletManager,this.movement={boundUp:-30,boundLeft:10,boundRight:70,boundDown:45,move:10}}init(){this.playerSpriteSheet.addSpriteBulk(this.spriteNames,this.spriteSheet.rows,this.spriteSheet.columns),this._startInputListeners()}playerMovement(){this.pressed.left&&this.position.x>this.movement.boundLeft?this.position.x-=this.movement.move:this.pressed.right&&this.position.x<this.canvasSize.width-this.movement.boundRight?this.position.x+=this.movement.move:this.pressed.up&&this.position.y>this.movement.boundUp?this.position.y-=this.movement.move:this.pressed.down&&this.position.y<this.canvasSize.height-this.movement.boundDown&&(this.position.y+=this.movement.move)}_drawFrame(t,e,i){this.lives=e,this.bulletCount=i;const s=this.playerAnimator.state;if(Util.exitFire(this.pressed.pew,s)&&(this.pressed.pew=!1),this.pressed.absorb?this.playerAnimator.absorbAnimation():this.pressed.pew?this.playerAnimator.fireAnimation():Util.isIdleAnim(s)&&this.playerAnimator.idleAnimation(),Util.imgDrawCall(this.ctx,this.playerSpriteSheet,this.spriteNames[s],this.spriteSheet.spriteSize,this.position.x,this.position.y,this.scale.player),!0===this.pressed.absorb&&this.bulletCount>=this.maxBulletSize&&this._absorbKeyUp(new KeyboardEvent("keyup",{code:this.keys.absorb})),this.pressed.absorb){const t=Util.getBarrierPosition(this.scale.player,this.scale.barrier,this.spriteSheet.spriteSize),e=this.position.x-t,i=this.position.y-t;Util.imgDrawCall(this.ctx,this.playerSpriteSheet,this.spriteNames[6],this.spriteSheet.spriteSize,e,i,this.scale.barrier)}this.bulletManager.draw(t),this.playerAnimator.incrementFrame=1}_startInputListeners(){document.addEventListener("keydown",this._moveKey.bind(this),!1),document.addEventListener("keyup",this._moveKey.bind(this),!1),document.addEventListener("keydown",this._fireKeyDown.bind(this),!1),document.addEventListener("keydown",this._absorbKeyDown.bind(this),!1),document.addEventListener("keyup",this._absorbKeyUp.bind(this),!1)}_stopInputListeners(){document.removeEventListener("keydown",this._moveKey.bind(this),!1),document.removeEventListener("keyup",this._moveKey.bind(this),!1),document.removeEventListener("keydown",this._fireKeyDown.bind(this),!1),document.removeEventListener("keydown",this._absorbKeyDown.bind(this),!1),document.removeEventListener("keyup",this._absorbKeyUp.bind(this),!1)}_moveKey(t){let e;switch("keydown"==t.type?e=!0:"keyup"==t.type&&(e=!1),t.code){case this.keys.left:this.pressed.left=e;break;case this.keys.right:this.pressed.right=e;break;case this.keys.up:this.pressed.up=e;break;case this.keys.down:this.pressed.down=e}}_fireKeyDown(t){t.repeat||this.pressed.absorb||t.code===this.keys.pew&&this.bulletCount>0&&(this.decrementBulletCount(),this._fireBullet(),this.playerAnimator.resetFrameCounter(),this.pressed.pew=!0,this.playerAnimator.fireAnimation(),AudioEffects.playPlayerPewSound())}_fireBullet(){this.bulletManager.addBullet(new Bullet({x:this.position.x+35,y:this.position.y+35},this.images[1],10,this.ctx,this.canvasSize,1,!0))}_absorbKeyDown(t){t.code===this.keys.absorb&&this.bulletCount<this.maxBulletSize&&(this.pressed.absorb=!0)}_absorbKeyUp(t){t.code===this.keys.absorb&&this.pressed.absorb&&(this.pressed.absorb=!1,this.playerAnimator.resetFrameCounter(),this.playerAnimator.returnToIdle(4,5))}destroy(){this.position=null,this.bulletCount=0,this._stopInputListeners()}decrementBulletCount(){this.bulletCount>0&&this.bulletCount--}}class Font{static draw(t,e,i,s,h){const r=this._getChars(t);let l=s;for(let t=0;t<r.length;t++){const s=r[t];let a=h,n=0;for(let t=0;t<s.length;t++){const h=s[t];for(let t=0;t<h.length;t++)h[t]&&i.fillRect(l+t*e,a,e,e);n=Math.max(n,h.length*e),a+=e}l+=e+n}}static _getChars(t){const e={A:[[,1],[1,,1],[1,,1],[1,1,1],[1,,1]],B:[[1,1],[1,,1],[1,1,1],[1,,1],[1,1]],C:[[1,1,1],[1],[1],[1],[1,1,1]],D:[[1,1],[1,,1],[1,,1],[1,,1],[1,1]],E:[[1,1,1],[1],[1,1,1],[1],[1,1,1]],F:[[1,1,1],[1],[1,1],[1],[1]],G:[[,1,1],[1],[1,,1,1],[1,,,1],[,1,1]],H:[[1,,1],[1,,1],[1,1,1],[1,,1],[1,,1]],I:[[1,1,1],[,1],[,1],[,1],[1,1,1]],J:[[1,1,1],[,,1],[,,1],[1,,1],[1,1,1]],K:[[1,,,1],[1,,1],[1,1],[1,,1],[1,,,1]],L:[[1],[1],[1],[1],[1,1,1]],M:[[1,1,1,1,1],[1,,1,,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,1],[1,1,,1],[1,,1,1],[1,,,1],[1,,,1]],O:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],P:[[1,1,1],[1,,1],[1,1,1],[1],[1]],Q:[[0,1,1],[1,,,1],[1,,,1],[1,,1,1],[1,1,1,1]],R:[[1,1],[1,,1],[1,,1],[1,1],[1,,1]],S:[[1,1,1],[1],[1,1,1],[,,1],[1,1,1]],T:[[1,1,1],[,1],[,1],[,1],[,1]],U:[[1,,1],[1,,1],[1,,1],[1,,1],[1,1,1]],V:[[1,,,,1],[1,,,,1],[,1,,1],[,1,,1],[,,1]],W:[[1,,,,1],[1,,,,1],[1,,,,1],[1,,1,,1],[1,1,1,1,1]],X:[[1,,,,1],[,1,,1],[,,1],[,1,,1],[1,,,,1]],Y:[[1,,1],[1,,1],[,1],[,1],[,1]],Z:[[1,1,1,1,1],[,,,1],[,,1],[,1],[1,1,1,1,1]],0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],1:[[,1],[,1],[,1],[,1],[,1]],2:[[1,1,1],[0,0,1],[1,1,1],[1,0,0],[1,1,1]],3:[[1,1,1],[0,0,1],[1,1,1],[0,0,1],[1,1,1]],4:[[1,0,1],[1,0,1],[1,1,1],[0,0,1],[0,0,1]],5:[[1,1,1],[1,0,0],[1,1,1],[0,0,1],[1,1,1]],6:[[1,1,1],[1,0,0],[1,1,1],[1,0,1],[1,1,1]],7:[[1,1,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1]],8:[[1,1,1],[1,0,1],[1,1,1],[1,0,1],[1,1,1]],9:[[1,1,1],[1,0,1],[1,1,1],[0,0,1],[1,1,1]]," ":[[0],[0],[0],[0],[0]],".":[[0],[0],[0],[0],[1]],"-":[[0,0,0],[0,0,0],[1,1,1],[0,0,0],[0,0,0]],"/":[[0,0,0],[0,0,1],[0,1,0],[1,0,0],[0,0,0]]},i=[];t=t.toUpperCase();for(let s=0;s<t.length;s++){const h=e[t.charAt(s)];h&&i.push(h)}return i}}class UserInterface{constructor(t,e,i,s){this.ctx=t,this.canvasSize=e,this.version=i,this.healthSpriteSheet=new SpriteSheet(s[0],5),this.countSpriteSheet=new SpriteSheet(s[1],7),this.logoSpriteSheet=new SpriteSheet(s[2],15),this.names=["a","b","c","d","e","f"],this.states={START:0,GAME:1,GAMEOVER:2},this.currentState=this.states.START}init(){this.healthSpriteSheet.addSpriteBulk(this.names.slice(0,4),1,4),this.countSpriteSheet.addSpriteBulk(this.names,1,6),this.logoSpriteSheet.addSprite({name:"logo",x:0,y:0})}draw(t=0,e=0,i=0){switch(this.ctx.clearRect(0,0,this.canvasSize.width,this.canvasSize.height),this.currentState){case this.states.START:this._drawLogo(),this.ctx.fillStyle="#daf3ec",this._drawControls(565,485),Font.draw(this.version,2,this.ctx,10,10),Font.draw("Press space to start",4.11,this.ctx,250,430),Font.draw("Source code and license",2,this.ctx,10,545),Font.draw("github.com/FR0ST1N/Pew-Pew",2,this.ctx,10,565);break;case this.states.GAME:this._drawHealth(t),this._drawBulletCount(e),this._drawScore(i.toString(),5);break;case this.states.GAMEOVER:this.ctx.fillStyle="#daf3ec",Font.draw("Your score is",5,this.ctx,50,300),Font.draw("Press space to play again",5,this.ctx,50,350),this.ctx.fillStyle="#00bff3",Font.draw(i.toString(),5,this.ctx,300,300)}}_drawLogo(){const t=20*this.logoSpriteSheet.spriteSize;Util.imgDrawCall(this.ctx,this.logoSpriteSheet,"logo",this.logoSpriteSheet.spriteSize,(800-t)/2,(600-t)/2,20)}_drawHealth(t){t>-1&&Util.imgDrawCall(this.ctx,this.healthSpriteSheet,this.names[t],this.healthSpriteSheet.spriteSize,10,550,7)}_drawBulletCount(t){t>-1&&Util.imgDrawCall(this.ctx,this.countSpriteSheet,this.names[t],this.countSpriteSheet.spriteSize,50,540,7)}_drawScore(t,e){this.ctx.fillStyle="#00bff3";const i=20*(t.length-1);Font.draw(t,e,this.ctx,775-i,10)}_drawControls(t,e){this.ctx.strokeStyle="#daf3ec",this.ctx.lineWidth=2,this.ctx.strokeRect(t,e,210,90),Font.draw("Controls",2.5,this.ctx,t+10,e+10),Font.draw("Arrow Keys - Movement",2.2,this.ctx,t+10,e+30),Font.draw("z - Barrier",2.2,this.ctx,t+10,e+50),Font.draw("x - pew",2.2,this.ctx,t+10,e+70)}}class CollisionManager{constructor(t,e,i,s){this.ctx=t,this.playerDimensions=e,this.enemyDimensions=s,this.playerAbsorbDimensions=i,this.enemies=[],this.enemyBullets=[],this.playerBullets=[],this.playerBulletCount=0,this.playerHealth=0,this.playerPosition={x:0,y:0}}checkCollision(t,e,i,s,h,r,l,a,n){this.playerBullets=t,this.enemyBullets=e,this.playerPosition=i,this.playerAbsorb=s,this.enemies=h,this.playerHealth=r,this.playerBulletCount=l,this.score=a,this.level=n,this._checkPlayerBulletsCollision(),this._checkEnemiesBulletsCollision(s),this.enemies=this.enemies.filter(t=>t.health>0),this.playerBullets>0&&(this.playerBullets=this.playerBullets.filter(t=>!t.destroy)),this.enemyBullets.length>0&&(this.enemyBullets=this.enemyBullets.filter(t=>!t.destroy))}_checkPlayerBulletsCollision(){for(let t=0;t<this.playerBullets.length;t++)if(!this.playerBullets[t].destroy)for(let e=0;e<this.enemies.length;e++)this.enemies[e].health>0&&this._isColliding(this.enemies[e].position,this.enemyDimensions,this.playerBullets[t])&&(this.enemies[e].health-=1,this.playerBullets[t].destroy=!0,this.enemies[e].health<=0&&this.score.setScore(this.level),AudioEffects.playEnemyDamageSound())}_checkEnemiesBulletsCollision(t){for(let e=0;e<this.enemyBullets.length;e++)if(!this.enemyBullets[e].destroy){let i=null,s=null;t?(i=this.playerAbsorbDimensions,s=this._getPlayerBarrierPosition()):(i=this.playerDimensions,s=this.playerPosition),this._isColliding(s,i,this.enemyBullets[e])&&(t?(this.playerBulletCount+=1,AudioEffects.playBarrierSound()):this.playerHealth>0&&(this.playerHealth-=1,AudioEffects.playPlayerDamageSound()),this.enemyBullets[e].destroy=!0)}}_getPlayerBarrierPosition(){const t=Util.getBarrierPosition(this.playerDimensions.scale,this.playerAbsorbDimensions.scale,32);return{x:this.playerPosition.x-t,y:this.playerPosition.y-t}}_removeEnemy(t){this.enemies.splice(t,1)}_isColliding(t,e,i,s=!1){const h={x:i.position.x,y:i.position.y,width:i.size*i.scale,height:i.size},r={x:t.x,y:t.y,width:e.width,height:e.height};return s&&(this.ctx.save(),this.ctx.strokeStyle="#39FF14",this.ctx.beginPath(),this.ctx.rect(r.x,r.y,r.width,r.height),this.ctx.rect(h.x,h.y,h.width,h.height),this.ctx.stroke(),this.ctx.restore()),CollisionDetection.detect(h,r)}}class CollisionDetection{static detect(t,e){let i=!1;return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y&&(i=!0),i}}class BulletManager{constructor(){this.bullets=[]}draw(t){this.bullets=t;for(let t=0;t<this.bullets.length;t++)this.bullets[t].destroy?this._removeBullet(t):this.bullets[t].draw()}addBullet(t){this.bullets[this.bullets.length]=t}_removeBullet(t){this.bullets.splice(t,1)}}class Bullet{constructor(t,e,i,s,h,r=1,l=!1){this.position=t,this.image=e,this.speed=i,this.ctx=s,this.canvasSize=h,this.damage=r,this.isPlayer=l,this.destroy=!1,this.size=5,this.scale=5}draw(){!this.destroy&&this._isInsideCanvas()?(this.isPlayer?this.position.x+=this.speed:this.position.x-=this.speed,this.ctx.drawImage(this.image,0,0,this.size,this.size,this.position.x,this.position.y,this.size*this.scale,this.size*this.scale)):this.destroy||this._destroy()}_isInsideCanvas(){const t=-20,e=-20,i=this.canvasSize.width+20,s=this.canvasSize.height+20,h=this.position.x,r=this.position.y;return h>t&&r>e&&h<i&&r<s}_destroy(){this.position=null,this.image=null,this.speed=null,this.isPlayer=null,this.ctx=null,this.destroy=!0}}class EnemyMovement{static default(t,e){return{x:t,y:e}}static up(t,e,i){return{x:t,y:e+i}}static down(t,e,i){return{x:t,y:e-i}}static upDown(t,e,i){return e?this.up(t.x,t.y,i):this.down(t.x,t.y,i)}}class Enemy{constructor(t,e,i,s,h,r,l,a,n){this.ctx=t,this.canvasSize=e,this.spriteSheet=i,this.position=s,this.originalPosition=s,this.health=h,this.movementSpeed=r,this.bulletSpeed=l,this.interval=a,this.movementIndex=n,this.enemyAnimator=new Animator,this.enemySpriteSheet=new SpriteSheet(i.image,i.spriteSize),this.spriteNames=["idle1","idle2","fire1","fire2"],this.enemySpriteSheet.addSpriteBulk(this.spriteNames,i.rows,i.columns),this.fire=!1,this.scale=1.5,this.up=!0}draw(){const t=this.enemyAnimator.state;Util.exitFire(this.fire,t)&&(this.fire=!1),this.fire?this.fire&&this.enemyAnimator.fireAnimation():this.enemyAnimator.idleAnimation(),this._updatePosition(),Util.imgDrawCall(this.ctx,this.enemySpriteSheet,this.spriteNames[t],this.spriteSheet.spriteSize,this.position.x,this.position.y,this.scale),this.enemyAnimator.incrementFrame=1}_setUpDownTriggers(t,e){this.position.y==t?this.up=!0:this.position.y==e&&(this.up=!1)}_updatePosition(){switch(this.movementIndex){case 0:this._setUpDownTriggers(this.originalPosition.y,this.originalPosition.y+25),this.position=EnemyMovement.upDown(this.position,this.up,this.movementSpeed);break;case 1:this._setUpDownTriggers(0,this.canvasSize.height-50),this.position=EnemyMovement.upDown(this.position,this.up,this.movementSpeed)}}pew(){this.enemyAnimator.resetFrameCounter(),this.fire=!0,this.enemyAnimator.fireAnimation(),AudioEffects.playEnemyPewSound()}}class Level{constructor(t,e,i){this.ctx=t,this.canvasSize=e,this.images=i,this.stages=[[{x:700,y:75},{x:600,y:175},{x:550,y:275},{x:600,y:375},{x:700,y:475}],[{x:300,y:50},{x:350,y:e.height-50},{x:400,y:50},{x:450,y:e.height-50},{x:500,y:50},{x:550,y:e.height-50}]],this.movementSpeeds=[1,10],this.enemies=[],this.enemyBullets=[],this.bulletManager=new BulletManager,this.stage=this.stages.length-1,this.level=0,this.maxFrames=60,this.frame=1}draw(t,e){this.enemies=t,this.enemyBullets=e;for(let t=0;t<this.enemies.length;t++)this.enemies[t].interval===this.frame&&(this.enemyBullets[e.length]=new Bullet({x:this.enemies[t].position.x-15,y:this.enemies[t].position.y+10},this.images[1],this.enemies[t].bulletSpeed,this.ctx,this.canvasSize),this.enemies[t].pew()),this.enemies[t].draw();if(this.bulletManager.draw(e),this.frame=this.frame<=this.maxFrames?++this.frame:1,0===this.enemies.length){const t=++this.stage%this.stages.length;this.stage=t,this.level=0===t?++this.level:this.level,this.loadStage(this.stage)}}destroy(){for(const t of this.enemies)t.position=null;for(const t of this.enemyBullets)t.position=null;this.enemies=null,this.enemyBullets=null}loadStage(t){const e=this.stages[t],i=this.movementSpeeds[t];for(let t=0;t<e.length;t++)this.enemies[t]=new Enemy(this.ctx,this.canvasSize,{image:this.images[0],spriteSize:32,rows:2,columns:2},{x:e[t].x,y:e[t].y},this.level,i,10,60,this.stage)}}class Game{constructor(t,e,i,s,h){t.width=i,t.height=s,e.width=i,e.height=s,this.width=i,this.height=s,this.ctx=t.getContext("2d"),this.uiCtx=e.getContext("2d"),this.canvasSize={width:this.width,height:this.height},this.images=h,this.globalObject={player:null,ui:null,score:null,level:null},this.previous={health:null,bullets:null,score:null},this.requestAnimationFrameId=null,this.version="v1.1.0",this.collisionManager=null}init(){this.ctx.imageSmoothingEnabled=!1,this.uiCtx.imageSmoothingEnabled=!1,this.ctx.globalCompositeOperation="source-over",this.globalObject.player=this._createPlayer(),this.globalObject.player.init();const t=this.images.slice(2,5);this.globalObject.ui=new UserInterface(this.uiCtx,this.canvasSize,this.version,t),this.globalObject.ui.init(),this.globalObject.score=new Score,this.globalObject.ui.draw(),this._uiInputListener(),this.collisionManager=this._createCollisionManager(),this.globalObject.level=this._createLevel()}_render(){this.ctx.clearRect(0,0,this.width,this.height),this._isDead()||(this._redrawUI(),this._drawGame(),this.requestAnimationFrameId=window.requestAnimationFrame(this._render.bind(this)))}_isDead(){return this.globalObject.player.lives<=0&&(window.cancelAnimationFrame(this.requestAnimationFrameId),this.requestAnimationFrameId=null,this.globalObject.ui.currentState=this.globalObject.ui.states.GAMEOVER,this.globalObject.ui.draw(0,0,this.globalObject.score.getScore()),!0)}_redrawUI(){const t=this.globalObject.player.lives,e=this.globalObject.player.bulletCount,i=this.globalObject.score.getScore();this.previous.health==t&&this.previous.bullets==e&&this.previous.score==i||this.globalObject.ui.draw(t,e,i),this.previous.health=t,this.previous.bullets=e,this.previous.score=i}_drawGame(){this.collisionManager.checkCollision(this.globalObject.player.bulletManager.bullets,this.globalObject.level.bulletManager.bullets,this.globalObject.player.position,this.globalObject.player.pressed.absorb,this.globalObject.level.enemies,this.globalObject.player.lives,this.globalObject.player.bulletCount,this.globalObject.score,this.globalObject.level.level),this.globalObject.score=this.collisionManager.score,this.globalObject.player.playerMovement(),this.globalObject.player._drawFrame(this.collisionManager.playerBullets,this.collisionManager.playerHealth,this.collisionManager.playerBulletCount),this.globalObject.level.draw(this.collisionManager.enemies,this.collisionManager.enemyBullets)}_createCollisionManager(){return new CollisionManager(this.ctx,{scale:this.globalObject.player.scale.player,width:32*this.globalObject.player.scale.player,height:32*this.globalObject.player.scale.player},{scale:this.globalObject.player.scale.barrier,width:32*this.globalObject.player.scale.barrier,height:32*this.globalObject.player.scale.barrier},{width:48,height:48})}_createLevel(){return new Level(this.ctx,this.canvasSize,this.images.slice(5,7))}_createPlayer(){const t=this.images.slice(0,2);return new Player({image:null,spriteSize:32,rows:4,columns:2},["idle1","idle2","fire1","fire2","absorb1","absorb2","shield","blank"],this.ctx,this.canvasSize,{left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",pew:"KeyX",absorb:"KeyZ"},t)}_resetGame(){this.globalObject.score.resetScore(),this.globalObject.player.destroy(),this.globalObject.player=this._createPlayer(),this.globalObject.player.init(),this.previous={health:null,bullets:null,score:null},this.globalObject.level.destroy(),this.globalObject.level=this._createLevel(),this.collisionManager=this._createCollisionManager()}_uiInputListener(){document.addEventListener("keydown",this._uiInput.bind(this),!1)}_uiInput(t){if(t.repeat)return;const e=this.globalObject.ui;"Space"===t.code&&(e.currentState!==e.states.START&&e.currentState!==e.states.GAMEOVER||(AudioEffects.playUiSound(),e.currentState==e.states.GAMEOVER&&this._resetGame(),e.currentState=e.states.GAME,this._render()))}}function loadImages(t,e){const i=[];let s=0;for(let h=0;h<t.length;h++)i[h]=new Image,i[h].onload=function(){++s>=t.length&&e(i)},i[h].src=t[h]}function main(t){const e=document.getElementById("game"),i=document.getElementById("ui");new Game(e,i,800,600,t).init()}window.onload=function(){loadImages(["images/player.png","images/player_bullet.png","images/ui_heart.png","images/ui_bullet_holder.png","images/logo.png","images/enemy1.png","images/enemy_bullet.png"],main)};